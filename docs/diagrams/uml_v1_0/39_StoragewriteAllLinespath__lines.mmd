flowchart TD
  classDef err fill:#ffecec,stroke:#c00,color:#600
  classDef ok fill:#eaffea,stroke:#0a0,color:#060

  A([Start]) --> B[Open file]
  B --> C{Open ok?}
  C -- No --> E_IO[Throw IOError]
  C -- Yes --> D[Write line loop]
  D --> E{Done?}
  E -- No --> F[Write line]
  F --> G{Write ok?}
  G -- No --> E_IO
  G -- Yes --> D
  E -- Yes --> Z([End])
  E_IO --> Z

  class E_IO err
  class Z ok
